const mysql = require('mysql')

//crypto package
const CryptoJS = require('crypto-js');
const key = 'sed-lyf-of-munmun';
let id_counter = 1;

//database connection
const con = mysql.createConnection({
  host: 'localhost',
  user: 'root',
  password: '12345',
  database: 'chatapp'
});

//algo star
    const start = Date.now();

    const ciphertext = CryptoJS.AES.encrypt( data.message, key, {
      mode: CryptoJS.mode.CBC,
      padding: CryptoJS.pad.Pkcs7,
    }).toString();

    const mid = Date.now();

    const decrypted = CryptoJS.AES.decrypt(ciphertext, key, {
      mode: CryptoJS.mode.CBC,
      padding: CryptoJS.pad.Pkcs7,
    }).toString(CryptoJS.enc.Utf8);
    
    const end = Date.now();

    enctime = mid - start
    dectime = end - mid
    filesize = data.message.length * 4;

    con.query('insert into data values('+ id_counter +','+ filesize +','+ enctime +','+ dectime +', "AES")' )
    
    id_counter++;
    
    console.log("values entered")
    //algo end